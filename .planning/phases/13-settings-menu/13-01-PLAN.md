---
phase: 13-settings-menu
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/ui/SettingsModal.ts
  - src/main.ts
  - src/style.css
  - src/types/index.ts
  - src/utils/settings.ts
autonomous: false
---

<objective>
Create Settings modal with toggle switches for app preferences.

Purpose: Consolidate settings into a single modal accessible from the gear icon in the header, providing a clean interface for managing app preferences.
Output: SettingsModal component with working toggles for theme, word list visibility, and hard mode.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
@~/.claude/get-shit-done/references/checkpoints.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/12-header-layout/12-01-SUMMARY.md

# Source files to reference for patterns:
@src/ui/StatsModal.ts
@src/main.ts
@src/style.css
@src/utils/theme.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create settings persistence and types</name>
  <files>src/types/index.ts, src/utils/settings.ts</files>
  <action>
    1. Add AppSettings interface to src/types/index.ts:
       - theme: 'light' | 'dark' | 'system'
       - showSuggestions: boolean
       - hardMode: boolean

    2. Create src/utils/settings.ts with:
       - SETTINGS_KEY = 'wordle-helper-settings'
       - loadSettings(): AppSettings - load from localStorage with defaults
       - saveSettings(settings: AppSettings): void - persist to localStorage
       - Default values: theme='system', showSuggestions=true, hardMode=false

    Avoid: Don't change existing theme.ts - settings.ts will use the theme toggle functions.
  </action>
  <verify>TypeScript compiles without errors: npm run build</verify>
  <done>AppSettings type exported, loadSettings/saveSettings functions work with localStorage</done>
</task>

<task type="auto">
  <name>Task 2: Create SettingsModal component</name>
  <files>src/ui/SettingsModal.ts, src/style.css</files>
  <action>
    Create src/ui/SettingsModal.ts following StatsModal pattern:

    1. Component structure:
       - Modal overlay with same animation pattern as StatsModal
       - Header with "Settings" title and close button
       - Content area with toggle switches

    2. Toggle switches to include:
       - Dark Theme: toggle between light/dark (use existing theme functions)
       - Hard Mode: when enabled, guesses must use revealed hints
       - Show Suggestions: toggle visibility of word suggestions panel

    3. Each toggle switch:
       - Label on left, toggle switch on right
       - Description text below label (smaller, muted color)
       - Switch uses checkbox input styled as toggle

    4. Methods:
       - constructor(containerElement, onSettingsChange callback)
       - render(settings: AppSettings): void
       - show(): void
       - hide(): void
       - getSettings(): AppSettings

    5. Add CSS for settings modal in src/style.css:
       - .settings-modal-overlay (reuse overlay pattern)
       - .settings-modal (reuse modal pattern)
       - .settings-item (flex row: label left, toggle right)
       - .settings-label (name + description)
       - .settings-toggle (styled checkbox switch)

    Toggle switch styling:
    - Use CSS-only toggle (hidden checkbox + styled span)
    - 40px wide, 24px tall, pill-shaped
    - Off: gray background, circle left
    - On: green background, circle right
    - Smooth transition (0.2s)
  </action>
  <verify>npm run build succeeds, no TypeScript errors</verify>
  <done>SettingsModal component renders with 3 toggle switches, follows existing modal patterns</done>
</task>

<task type="auto">
  <name>Task 3: Wire up settings modal and integrate with app</name>
  <files>src/main.ts</files>
  <action>
    1. Import SettingsModal and settings utils at top of main.ts

    2. Initialize settings on app load:
       - Load settings from localStorage
       - Apply initial theme (already works via getInitialTheme)
       - Apply initial suggestions visibility (add hidden class if false)
       - Apply initial hard mode (store in app state)

    3. Initialize SettingsModal:
       - Create instance after appContainer reference
       - Set onSettingsChange callback to:
         a. Update theme using setTheme()
         b. Toggle suggestions panel visibility
         c. Update hardMode state
         d. Save settings to localStorage

    4. Wire up settings button click handler:
       - Render current settings
       - Show modal

    5. Remove theme toggle from header:
       - Remove .theme-btn from click handler delegation exclusions (keep settings-btn)
       - Theme is now controlled from settings modal only

    6. Apply suggestions visibility:
       - Add/remove 'hidden' class on .suggestions-area based on setting
       - Apply on load and when setting changes

    7. Hard mode integration:
       - Store hardMode in app state (let hardModeEnabled: boolean)
       - When enabled, filter suggestions to only valid hard-mode guesses
       - Hook into existing constraint system (Phase 7 established hard mode)
  </action>
  <verify>
    - npm run build succeeds
    - Settings button opens modal
    - Toggles persist after page reload
  </verify>
  <done>
    - Settings modal opens from gear icon
    - Theme toggle works and persists
    - Suggestions visibility toggles and persists
    - Hard mode toggle updates and persists
    - Settings survive page refresh
  </done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Settings modal with theme, suggestions visibility, and hard mode toggles</what-built>
  <how-to-verify>
    1. Run: npm run dev
    2. Visit: http://localhost:5173
    3. Click the gear icon in header - settings modal should open
    4. Test Theme toggle:
       - Toggle switch should change light/dark immediately
       - Close modal - theme persists
       - Refresh page - theme still persists
    5. Test Show Suggestions toggle:
       - Turn OFF - suggestions panel below keyboard should hide
       - Turn ON - suggestions panel reappears
       - Refresh - setting persists
    6. Test Hard Mode toggle:
       - Turn ON while playing
       - Make a guess with some green/yellow letters
       - Suggestions should only show words that use those hints
    7. Modal should close when clicking X or outside the modal
    8. Theme toggle button should be removed from header (settings gear remains)
  </how-to-verify>
  <resume-signal>Type "approved" to continue, or describe issues to fix</resume-signal>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] npm run build succeeds without errors
- [ ] Settings modal opens from gear icon in header
- [ ] All three toggles work and persist to localStorage
- [ ] Theme changes are visible immediately
- [ ] Suggestions panel hides/shows based on setting
- [ ] No console errors
</verification>

<success_criteria>
- All tasks completed
- All verification checks pass
- Settings modal follows existing modal patterns
- Theme toggle removed from header (now in settings)
- Settings persist across page refreshes
- User approved visual layout
</success_criteria>

<output>
After completion, create `.planning/phases/13-settings-menu/13-01-SUMMARY.md`
</output>
