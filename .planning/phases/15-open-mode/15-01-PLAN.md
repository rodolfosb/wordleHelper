---
phase: 15-open-mode
plan: 01
type: execute
wave: 1
depends_on: []
files_modified: [src/types/index.ts, src/utils/settings.ts, src/data/words.ts, src/logic/filter.ts, src/ui/SettingsModal.ts, src/ui/GuessGrid.ts, src/main.ts, src/style.css]
autonomous: false
---

<objective>
Implement Open Mode with random word selection and variable word length support (4-10 letters).

Purpose: Allow users to play unlimited random games outside the NYT daily puzzle format, with configurable word lengths for variety and challenge.
Output: Fully functional Open Mode with word length selector and random word generation.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
@~/.claude/get-shit-done/references/checkpoints.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/14-word-sync-nyt/14-01-SUMMARY.md

@src/types/index.ts
@src/utils/settings.ts
@src/data/words.ts
@src/ui/SettingsModal.ts
@src/main.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add word lists for variable lengths (4, 6, 7, 8, 9, 10 letters)</name>
  <files>src/data/words.ts</files>
  <action>
Add additional word list exports for different lengths. Keep existing WORD_LIST (5-letter) and WORD_SET as the default.

Create new exports:
- WORD_LIST_4: 4-letter common words (500-800 words)
- WORD_LIST_6: 6-letter common words (500-800 words)
- WORD_LIST_7: 7-letter common words (400-600 words)
- WORD_LIST_8: 8-letter common words (300-500 words)
- WORD_LIST_9: 9-letter common words (200-400 words)
- WORD_LIST_10: 10-letter common words (150-300 words)

Add a helper function `getWordListForLength(length: number): string[]` that returns the appropriate word list.
Add a helper function `getWordSetForLength(length: number): Set<string>` that returns the appropriate word set for O(1) lookup.

Source words from common English word lists (crossword/puzzle-friendly words). Avoid obscure or offensive words. Each word must be exactly the specified length and lowercase.

The existing WORD_LIST should remain the default for 5-letter games.
  </action>
  <verify>TypeScript compiles without errors; getWordListForLength(5) returns WORD_LIST; all word lists contain valid words of correct length</verify>
  <done>Word lists for lengths 4-10 available via helper functions</done>
</task>

<task type="auto">
  <name>Task 2: Add wordLength setting and Open Mode state</name>
  <files>src/types/index.ts, src/utils/settings.ts</files>
  <action>
In src/types/index.ts, add to AppSettings:
- wordLength: number (4-10, default 5)

In src/utils/settings.ts, update DEFAULT_SETTINGS:
- Add wordLength: 5 as default

This setting only applies when nytMode is false (Open Mode).
  </action>
  <verify>TypeScript compiles; loadSettings() returns object with wordLength property</verify>
  <done>AppSettings includes wordLength with default 5</done>
</task>

<task type="auto">
  <name>Task 3: Add word length selector to Settings Modal</name>
  <files>src/ui/SettingsModal.ts, src/style.css</files>
  <action>
Add a dropdown/select for word length in SettingsModal:
- Label: "Word Length"
- Description: "Number of letters for Open Mode games"
- Options: 4, 5, 6, 7, 8, 9, 10
- Only enabled when NYT Mode is OFF (disabled when nytMode is true)

Add CSS styling for the select element to match existing toggle switches aesthetic (dark theme compatible).

When wordLength changes:
- Call notifySettingsChange() to trigger game reinit

Visual hint: Show "(NYT uses 5)" when NYT mode is on, disable the selector.
  </action>
  <verify>npm run build succeeds; settings modal shows word length selector; selector is disabled when NYT mode is on</verify>
  <done>Word length selector in settings, disabled in NYT mode</done>
</task>

<task type="auto">
  <name>Task 4: Update GuessGrid for variable word lengths</name>
  <files>src/ui/GuessGrid.ts, src/style.css</files>
  <action>
Modify GuessGrid to support variable word lengths:

1. Add constructor parameter for word length (default 5)
2. Add `setWordLength(length: number)` method that:
   - Clears and rebuilds the grid with new column count
   - Resets to row 0
   - Clears all state

3. Update grid rendering to use dynamic column count
4. Update all position calculations to use this.wordLength instead of hardcoded 5
5. Update maxLength in letter input handling

CSS changes:
- Use CSS Grid with dynamic columns: `grid-template-columns: repeat(var(--word-length), 1fr)`
- Add CSS custom property --word-length on grid element
- Adjust cell sizes for longer words (slightly smaller cells for 8-10 letters to fit screen)
  </action>
  <verify>npm run build succeeds; GuessGrid can be set to different word lengths</verify>
  <done>GuessGrid supports 4-10 letter words dynamically</done>
</task>

<task type="auto">
  <name>Task 5: Implement random word selection and Open Mode game flow</name>
  <files>src/main.ts</files>
  <action>
Implement Open Mode game logic:

1. Add `selectRandomWord(length: number): string` function that picks a random word from the appropriate word list

2. Update `initializeGame()`:
   - When nytMode is false:
     - Get wordLength from appSettings
     - Set guessGrid word length via setWordLength()
     - Select random word using selectRandomWord()
     - Store as currentPuzzle with synthetic HistoricalPuzzle (game: -1, date: '', answer: word)
     - Enable game mode for auto-color reveal
     - Update puzzle info to show "Open Mode (X letters)"

3. Update `resetGame()`:
   - When not in NYT mode, select a new random word (infinite replays)

4. Handle settings changes:
   - When wordLength changes in Open mode, reinit with new length
   - When switching from NYT to Open mode, init with selected word length

5. Update filtering to use correct word list:
   - `filteredWords = getWordListForLength(appSettings.wordLength)` in Open mode
   - Keep using WORD_LIST in NYT mode (always 5 letters)

6. Update isValidWord check to use correct word set for current length

7. Update `updatePuzzleInfo()` to show word length in Open mode:
   - "Open Mode (4 letters)", "Open Mode (5 letters)", etc.
  </action>
  <verify>npm run build succeeds; Open mode selects random words; Reset generates new random word; Word length from settings is respected</verify>
  <done>Open Mode fully functional with random word selection and variable lengths</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Open Mode with random word selection and variable word length (4-10 letters)</what-built>
  <how-to-verify>
    1. Run: npm run dev
    2. Visit: http://localhost:3000
    3. Open Settings (gear icon)
    4. Verify: NYT Mode toggle is ON by default
    5. Verify: Word Length selector shows "5" and is DISABLED (grayed out)
    6. Turn OFF NYT Mode
    7. Verify: Word Length selector is now ENABLED
    8. Verify: Puzzle info above grid shows "Open Mode (5 letters)"
    9. Play a 5-letter game - verify auto-color reveal works
    10. Click "Reset Game" - verify you get a NEW random word (not same word)
    11. Open Settings, change Word Length to 7
    12. Verify: Grid now has 7 columns
    13. Verify: Puzzle info shows "Open Mode (7 letters)"
    14. Play a 7-letter game - type valid 7-letter words
    15. Test with 4-letter and 10-letter words
    16. Turn NYT Mode back ON
    17. Verify: Grid returns to 5 columns
    18. Verify: Puzzle info shows "Wordle #XXXX (date)"
  </how-to-verify>
  <resume-signal>Type "approved" or describe issues to fix</resume-signal>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `npm run build` succeeds without errors
- [ ] `npm run dev` runs without console errors
- [ ] Word lists exist for lengths 4-10
- [ ] Settings modal shows word length selector
- [ ] Word length selector disabled when NYT mode on
- [ ] Open Mode selects random words
- [ ] Reset Game generates new random word in Open Mode
- [ ] Grid dynamically resizes for different word lengths
- [ ] Filtering uses correct word list for current length
</verification>

<success_criteria>

- All tasks completed
- All verification checks pass
- No TypeScript or runtime errors
- Open Mode provides unlimited random games
- Variable word length (4-10) fully functional
- User experience smooth and intuitive
</success_criteria>

<output>
After completion, create `.planning/phases/15-open-mode/15-01-SUMMARY.md`
</output>
