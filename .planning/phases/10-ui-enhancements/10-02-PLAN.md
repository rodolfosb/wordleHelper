---
phase: 10-ui-enhancements
plan: 02
type: execute
wave: 2
depends_on: ["10-01"]
files_modified: [src/style.css, src/main.ts, src/utils/theme.ts]
autonomous: true
---

<objective>
Add light/dark mode toggle with system preference detection and persistence.

Purpose: Allow users to choose their preferred color scheme, with dark mode matching Wordle's aesthetic.
Output: Working theme toggle in header, CSS theme system, persisted preference.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

@src/main.ts
@src/style.css
</context>

<tasks>

<task type="auto">
  <name>Task 1: Implement CSS theme system with variables</name>
  <files>src/style.css</files>
  <action>
Refactor CSS to use CSS custom properties (variables) for theme-aware colors:

1. Define CSS variables in :root for dark theme (current default):
   ```css
   :root {
     --bg-primary: #121213;
     --bg-secondary: #1a1a1a;
     --bg-tertiary: #2a2a2a;
     --text-primary: #ffffff;
     --text-secondary: #818384;
     --border-color: #3a3a3c;
     --cell-border: #3a3a3c;
     --cell-filled-border: #565758;
     --color-correct: #538d4e;
     --color-present: #b59f3b;
     --color-absent: #3a3a3c;
     --color-error: #e74c3c;
   }
   ```

2. Define light theme variables using [data-theme="light"]:
   ```css
   [data-theme="light"] {
     --bg-primary: #ffffff;
     --bg-secondary: #f5f5f5;
     --bg-tertiary: #e5e5e5;
     --text-primary: #1a1a1a;
     --text-secondary: #787c7e;
     --border-color: #d3d6da;
     --cell-border: #d3d6da;
     --cell-filled-border: #878a8c;
     --color-correct: #6aaa64;
     --color-present: #c9b458;
     --color-absent: #787c7e;
     --color-error: #e74c3c;
   }
   ```

3. Replace all hardcoded color values throughout the CSS with var(--variable-name).
   Key areas to update:
   - body/root background: var(--bg-primary)
   - .app-container, .suggestions-panel, modals: var(--bg-secondary)
   - .suggestion-item, hover states: var(--bg-tertiary)
   - Text colors: var(--text-primary), var(--text-secondary)
   - Borders: var(--border-color)
   - Cell colors: var(--color-correct), var(--color-present), var(--color-absent)
   - Button backgrounds (.reset-game-btn): var(--color-correct)

4. Update color-scheme property to respond to theme:
   - Dark: color-scheme: dark
   - Light: color-scheme: light

Avoid: Changing any layout or spacing - only colors should change.
  </action>
  <verify>
    - npm run build succeeds
    - Adding data-theme="light" to html element switches to light colors
    - Removing it reverts to dark theme
  </verify>
  <done>CSS uses variables for all theme colors, light/dark themes defined</done>
</task>

<task type="auto">
  <name>Task 2: Add theme toggle UI and persistence</name>
  <files>src/utils/theme.ts, src/main.ts</files>
  <action>
Create theme management utility and integrate toggle into header:

1. Create `src/utils/theme.ts`:
   ```typescript
   type Theme = 'light' | 'dark';
   const THEME_KEY = 'wordle-helper-theme';

   export function getStoredTheme(): Theme | null {
     return localStorage.getItem(THEME_KEY) as Theme | null;
   }

   export function getSystemTheme(): Theme {
     return window.matchMedia('(prefers-color-scheme: light)').matches ? 'light' : 'dark';
   }

   export function getInitialTheme(): Theme {
     return getStoredTheme() || getSystemTheme();
   }

   export function setTheme(theme: Theme): void {
     document.documentElement.setAttribute('data-theme', theme);
     localStorage.setItem(THEME_KEY, theme);
   }

   export function toggleTheme(): Theme {
     const current = document.documentElement.getAttribute('data-theme') as Theme || 'dark';
     const next = current === 'dark' ? 'light' : 'dark';
     setTheme(next);
     return next;
   }
   ```

2. Add theme toggle button to header in main.ts HTML template:
   - Add button with sun/moon SVG icons (sun for light mode active, moon for dark)
   - Place in .header-buttons before practice button
   - Use aria-label="Toggle theme"

3. Initialize theme on app load:
   ```typescript
   import { getInitialTheme, setTheme, toggleTheme } from './utils/theme';
   // On load:
   setTheme(getInitialTheme());
   ```

4. Add click handler for theme toggle:
   ```typescript
   const themeBtn = document.querySelector('.theme-btn');
   themeBtn.addEventListener('click', () => {
     const newTheme = toggleTheme();
     // Update button icon based on newTheme
   });
   ```

5. Add CSS for theme button (similar to other header buttons):
   - Transparent background, icon color matches text-secondary
   - Hover shows text-primary color

Avoid: Auto-switching based on system preference changes (keep it simple with manual toggle only).
  </action>
  <verify>
    - npm run build succeeds
    - Theme toggle button appears in header
    - Clicking toggles between light and dark themes
    - Theme persists after page reload
    - First load respects system preference if no stored preference
  </verify>
  <done>Theme toggle works, persists to localStorage, respects system preference on first visit</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] npm run build succeeds without errors
- [ ] Light theme has appropriate contrast and readability
- [ ] Dark theme matches original Wordle aesthetic
- [ ] Theme toggle button visible and functional
- [ ] Theme persists across page reloads
- [ ] All UI elements (grid, keyboard, suggestions, modals) theme correctly
</verification>

<success_criteria>

- All tasks completed
- All verification checks pass
- No TypeScript errors
- Both light and dark themes are visually polished
- Theme preference persists in localStorage
</success_criteria>

<output>
After completion, create `.planning/phases/10-ui-enhancements/10-02-SUMMARY.md`
</output>
